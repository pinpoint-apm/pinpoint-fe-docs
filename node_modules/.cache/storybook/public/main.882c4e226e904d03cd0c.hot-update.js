"use strict";
self["webpackHotUpdate_pinpoint_fe_scatter_chart"]("main",{

/***/ "./src/ui/Guide.ts":
/*!*************************!*\
  !*** ./src/ui/Guide.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Guide": () => (/* binding */ Guide)
/* harmony export */ });
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../node_modules/core-js/modules/web.timers.js */ "../../node_modules/core-js/modules/web.timers.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_timers_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.assign.js */ "../../node_modules/core-js/modules/es.object.assign.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.set-prototype-of.js */ "../../node_modules/core-js/modules/es.object.set-prototype-of.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.function.bind.js */ "../../node_modules/core-js/modules/es.function.bind.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.get-prototype-of.js */ "../../node_modules/core-js/modules/es.object.get-prototype-of.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.reflect.construct.js */ "../../node_modules/core-js/modules/es.reflect.construct.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_create_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.create.js */ "../../node_modules/core-js/modules/es.object.create.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_create_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_create_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.define-property.js */ "../../node_modules/core-js/modules/es.object.define-property.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_get_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.reflect.get.js */ "../../node_modules/core-js/modules/es.reflect.get.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_get_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_reflect_get_js__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_own_property_descriptor_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js */ "../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_own_property_descriptor_js__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_get_own_property_descriptor_js__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _constants_ui__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../constants/ui */ "./src/constants/ui.ts");
/* harmony import */ var _utils_draw__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utils/draw */ "./src/utils/draw.ts");
/* harmony import */ var _Layer__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Layer */ "./src/ui/Layer.ts");











function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }

function _get() { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, "prototype", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (typeof call === "object" || typeof call === "function")) { return call; } else if (call !== void 0) { throw new TypeError("Derived constructors may only return object or undefined"); } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }




var Guide = /*#__PURE__*/function (_Layer) {
  _inherits(Guide, _Layer);

  var _super = _createSuper(Guide);

  function Guide(wrapper, _ref) {
    var _this;

    var width = _ref.width,
        height = _ref.height,
        padding = _ref.padding,
        ratio = _ref.ratio,
        axisOption = _ref.axisOption;

    _classCallCheck(this, Guide);

    _this = _super.call(this, {
      width: width,
      height: height
    });
    _this.wrapper = void 0;
    _this.padding = void 0;
    _this.ratio = void 0;
    _this.axis = void 0;
    _this.isMouseDown = false;
    _this.isDragging = false;
    _this.dragStartX = 0;
    _this.dragStartY = 0;
    _this.eventHandlers = {};
    _this.canvas.style.position = 'absolute';
    _this.canvas.style.zIndex = '999';
    _this.canvas.style.top = '0px';
    _this.canvas.style.left = '0px';
    _this.canvas.style.background = 'transparent';
    _this.padding = padding;
    _this.ratio = ratio;
    _this.axis = axisOption;
    _this.wrapper = wrapper;

    _this.wrapper.append(_this.canvas);

    _this.addEventListener();

    return _this;
  }

  _createClass(Guide, [{
    key: "isMouseInValidArea",
    value: function isMouseInValidArea(x, y) {
      var width = this.canvas.width / this.dpr;
      var height = this.canvas.height / this.dpr;
      var padding = this.padding;
      return x >= padding.left + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING && x <= width - padding.right - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING && y >= padding.top + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING && y <= height - padding.bottom - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING;
    }
  }, {
    key: "addEventListener",
    value: function addEventListener() {
      var _this2 = this;

      var width = this.canvas.width / this.dpr;
      var height = this.canvas.height / this.dpr;
      this.canvas.addEventListener('mousedown', function (_ref2) {
        var offsetX = _ref2.offsetX,
            offsetY = _ref2.offsetY;
        _this2.isMouseDown = true;
        _this2.dragStartX = offsetX;
        _this2.dragStartY = offsetY;
      });
      this.canvas.addEventListener('mousemove', function (_ref3) {
        var offsetX = _ref3.offsetX,
            offsetY = _ref3.offsetY;

        _this2.context.clearRect(0, 0, width, height);

        var x = offsetX;
        var y = offsetY;

        if (_this2.isMouseInValidArea(x, y)) {
          // vertical line
          // drawLine(this.context, x , 0, x, height - padding.bottom + AXIS_INNER_PADDING)
          // horizontal line
          // drawLine(this.context, padding.left, y, width, y)
          _this2.drawGuideText(x, y);
        }

        if (_this2.isMouseDown) {
          _this2.isDragging = true;
          (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawRect)(_this2.context, _this2.dragStartX, _this2.dragStartY, offsetX - _this2.dragStartX, offsetY - _this2.dragStartY, {
            color: 'rgba(225,225,225,0.5)',
            strokeColor: 'blue'
          });
        }
      });
      this.canvas.addEventListener('mouseout', function (event) {
        _this2.isMouseDown = false;
        _this2.isDragging = false;

        _this2.context.clearRect(0, 0, width, height);
      });
      this.canvas.addEventListener('mouseup', function (event) {
        var offsetX = event.offsetX,
            offsetY = event.offsetY;

        _this2.context.clearRect(0, 0, width, height);

        if (_this2.isDragging) {
          var _this2$eventHandlers$, _this2$eventHandlers;

          _this2.isMouseInValidArea(offsetX, offsetY) && _this2.drawGuideText(offsetX, offsetY);
          (_this2$eventHandlers$ = (_this2$eventHandlers = _this2.eventHandlers)['dragEnd']) === null || _this2$eventHandlers$ === void 0 ? void 0 : _this2$eventHandlers$.call(_this2$eventHandlers, {
            x1: _this2.dragStartX / _this2.ratio.x + _this2.axis.x.min,
            y1: _this2.axis.y.max - (_this2.dragStartY - _this2.padding.top - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING) / _this2.ratio.y,
            x2: _this2.axis.y.max - (offsetX - _this2.padding.top - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING) / _this2.ratio.x + _this2.axis.x.min,
            y2: _this2.axis.y.max - (offsetY - _this2.padding.top - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING) / _this2.ratio.y
          });
        }

        _this2.isMouseDown = false;
      });
      this.canvas.addEventListener('click', function (event) {
        var offsetX = event.offsetX,
            offsetY = event.offsetY;

        if (!_this2.isDragging) {
          var _this2$eventHandlers$2, _this2$eventHandlers2;

          (_this2$eventHandlers$2 = (_this2$eventHandlers2 = _this2.eventHandlers)['click']) === null || _this2$eventHandlers$2 === void 0 ? void 0 : _this2$eventHandlers$2.call(_this2$eventHandlers2, {
            x: offsetX / _this2.ratio.x + _this2.axis.x.min,
            y: _this2.axis.y.max - (offsetY - _this2.padding.top - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING) / _this2.ratio.y
          });
        }

        _this2.isDragging = false;
      });
    }
  }, {
    key: "removeEventListener",
    value: function removeEventListener() {
      var _this$canvas$parentNo,
          _this3 = this;

      var newCanvas = this.canvas.cloneNode(true);
      (_this$canvas$parentNo = this.canvas.parentNode) === null || _this$canvas$parentNo === void 0 ? void 0 : _this$canvas$parentNo.replaceChild(newCanvas, this.canvas);
      setTimeout(function () {
        _this3.canvas.addEventListener('click', function () {
          return console.log('123');
        });
      }, 500);
    }
  }, {
    key: "drawGuideText",
    value: function drawGuideText(x, y) {
      var _axis$x$tick, _axis$y$tick;

      var padding = this.padding,
          context = this.context,
          canvas = this.canvas,
          ratio = this.ratio,
          axis = this.axis;
      var height = canvas.height / this.dpr;
      var xText = "" + ((_axis$x$tick = axis.x.tick) === null || _axis$x$tick === void 0 ? void 0 : _axis$x$tick.format((x - padding.left - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING) / ratio.x + axis.x.min));
      var yText = "" + ((_axis$y$tick = axis.y.tick) === null || _axis$y$tick === void 0 ? void 0 : _axis$y$tick.format(Math.floor(Math.abs((height - padding.bottom - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_INNER_PADDING - y) / ratio.y)))); // x

      var xTextWidth = this.getTextWidth(xText) + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_LEFT + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_RIGHT;
      var xTextHeight = this.getTextHeight(xText) + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_TOP + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_BOTTOM; // y

      var yTextWidth = this.getTextWidth(yText) + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_LEFT + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_RIGHT;
      var yTextHeight = this.getTextHeight(yText) + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_TOP + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_BOTTOM; // x

      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawRect)(context, x - xTextWidth / 2, height - padding.bottom + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_TICK_LENGTH, xTextWidth, xTextHeight, {
        color: 'black'
      });
      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawLine)(context, padding.left - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_TICK_LENGTH, y, padding.left, y);
      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawText)(context, xText, x, height - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_BOTTOM, {
        color: 'white',
        textAlign: 'center',
        textBaseline: 'bottom'
      }); // y

      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawRect)(context, padding.left - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_TICK_LENGTH - yTextWidth, y - yTextHeight / 2, yTextWidth, yTextHeight, {
        color: 'black'
      });
      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawLine)(context, x, height - padding.bottom, x, height - padding.bottom + _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_TICK_LENGTH);
      (0,_utils_draw__WEBPACK_IMPORTED_MODULE_11__.drawText)(context, yText, padding.left - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.AXIS_TICK_LENGTH - _constants_ui__WEBPACK_IMPORTED_MODULE_10__.TEXT_MARGIN_RIGHT, y + 3, {
        color: 'white',
        textAlign: 'end'
      });
    }
  }, {
    key: "setSize",
    value: function setSize(width, height) {
      _get(_getPrototypeOf(Guide.prototype), "setSize", this).call(this, width, height);

      this.removeEventListener(); // this.addEventListener();

      return this;
    }
  }, {
    key: "updateXAxis",
    value: function updateXAxis(x) {
      this.axis = Object.assign({}, this.axis, {
        x: Object.assign({}, this.axis.x, x)
      });
    }
  }, {
    key: "on",
    value: function on(evetntType, callback) {
      this.eventHandlers[evetntType] = callback;
    }
  }]);

  return Guide;
}(_Layer__WEBPACK_IMPORTED_MODULE_12__.Layer);

/***/ })

});
//# sourceMappingURL=main.882c4e226e904d03cd0c.hot-update.js.map