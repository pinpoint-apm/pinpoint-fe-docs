"use strict";
self["webpackHotUpdate_pinpoint_fe_scatter_chart"]("main",{

/***/ "./src/ui/ScatterChart.ts":
/*!********************************!*\
  !*** ./src/ui/ScatterChart.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ScatterChart": () => (/* binding */ ScatterChart)
/* harmony export */ });
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.function.bind.js */ "../../node_modules/core-js/modules/es.function.bind.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_bind_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.concat.js */ "../../node_modules/core-js/modules/es.array.concat.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_reduce_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.reduce.js */ "../../node_modules/core-js/modules/es.array.reduce.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_reduce_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_reduce_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.assign.js */ "../../node_modules/core-js/modules/es.object.assign.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_assign_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.for-each.js */ "../../node_modules/core-js/modules/es.array.for-each.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_for_each_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../node_modules/core-js/modules/web.dom-collections.for-each.js */ "../../node_modules/core-js/modules/web.dom-collections.for-each.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.keys.js */ "../../node_modules/core-js/modules/es.object.keys.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.filter.js */ "../../node_modules/core-js/modules/es.array.filter.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_values_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.values.js */ "../../node_modules/core-js/modules/es.object.values.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_values_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_values_js__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.define-property.js */ "../../node_modules/core-js/modules/es.object.define-property.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_is_array_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.is-array.js */ "../../node_modules/core-js/modules/es.array.is-array.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_is_array_js__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_is_array_js__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.symbol.js */ "../../node_modules/core-js/modules/es.symbol.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.symbol.description.js */ "../../node_modules/core-js/modules/es.symbol.description.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.object.to-string.js */ "../../node_modules/core-js/modules/es.object.to-string.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.symbol.iterator.js */ "../../node_modules/core-js/modules/es.symbol.iterator.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.string.iterator.js */ "../../node_modules/core-js/modules/es.string.iterator.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.iterator.js */ "../../node_modules/core-js/modules/es.array.iterator.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../node_modules/core-js/modules/web.dom-collections.iterator.js */ "../../node_modules/core-js/modules/web.dom-collections.iterator.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_17__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.from.js */ "../../node_modules/core-js/modules/es.array.from.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_18__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.array.slice.js */ "../../node_modules/core-js/modules/es.array.slice.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../node_modules/core-js/modules/es.function.name.js */ "../../node_modules/core-js/modules/es.function.name.js");
/* harmony import */ var _Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(_Users_dy_dy_projects_pinpoint_web_src_main_web_frontend_node_modules_core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! lodash.merge */ "../../node_modules/lodash.merge/index.js");
/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(lodash_merge__WEBPACK_IMPORTED_MODULE_21__);
/* harmony import */ var _Layer__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./Layer */ "./src/ui/Layer.ts");
/* harmony import */ var _Viewport__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./Viewport */ "./src/ui/Viewport.ts");
/* harmony import */ var _utils_draw__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../utils/draw */ "./src/utils/draw.ts");
/* harmony import */ var _YAxis__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./YAxis */ "./src/ui/YAxis.ts");
/* harmony import */ var _XAxis__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./XAxis */ "./src/ui/XAxis.ts");
/* harmony import */ var _constants_ui__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../constants/ui */ "./src/constants/ui.ts");
/* harmony import */ var _GridAxis__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./GridAxis */ "./src/ui/GridAxis.ts");
/* harmony import */ var _Legend__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./Legend */ "./src/ui/Legend.ts");
/* harmony import */ var _Guide__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./Guide */ "./src/ui/Guide.ts");
/* harmony import */ var _constants_options__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../constants/options */ "./src/constants/options.ts");
function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }























function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, "prototype", { writable: false }); return Constructor; }












var ScatterChart = /*#__PURE__*/function () {
  function ScatterChart(wrapper, options) {
    _classCallCheck(this, ScatterChart);

    this.wrapper = void 0;
    this.canvasWrapper = void 0;
    this.options = void 0;
    this.xAxis = void 0;
    this.yAxis = void 0;
    this.gridAxis = void 0;
    this.legend = void 0;
    this.dataColorMap = void 0;
    this.viewport = void 0;
    this.guide = void 0;
    this.layers = {};
    this.datas = {};
    this.xRatio = 1;
    this.yRatio = 1;
    this.coordX = 0;
    this.coordY = 0;
    this.realtimeAxisMinX = 0;
    this.realtimeAxisMaxX = 0;
    this.width = 0;
    this.height = 0;
    this.padding = {
      top: 15,
      bottom: 20,
      left: 0,
      right: 0
    };
    this.t0 = 0;
    this.reqAnimation = 0;
    this.wrapper = wrapper;
    this.canvasWrapper = document.createElement('div');
    this.canvasWrapper.style.position = 'relative';
    this.wrapper.append(this.canvasWrapper);
    this.setOptions(options);
    this.setWidthAndHeight();
    this.setViewPort();
    this.setPadding();
    this.setRatio();
    this.setAxis();
    this.setGuide();
    this.setLayers();
    this.setLegends();
    this.shoot();
    this.animate = this.animate.bind(this);
  }

  _createClass(ScatterChart, [{
    key: "setOptions",
    value: function setOptions(options) {
      this.options = {
        // TODO deep copy
        axis: lodash_merge__WEBPACK_IMPORTED_MODULE_21___default()(_constants_options__WEBPACK_IMPORTED_MODULE_31__.defaultAxisOption, options.axis),
        data: [].concat(_toConsumableArray(_constants_options__WEBPACK_IMPORTED_MODULE_31__.defaultDataOption), _toConsumableArray(options.data)),
        legend: lodash_merge__WEBPACK_IMPORTED_MODULE_21___default()(_constants_options__WEBPACK_IMPORTED_MODULE_31__.defaultLegendOption, options.legend)
      };
      this.dataColorMap = this.options.data.reduce(function (prev, curr) {
        var _Object$assign;

        return Object.assign((_Object$assign = {}, _Object$assign[curr.type] = curr.color, _Object$assign), prev);
      }, {});
    }
  }, {
    key: "setWidthAndHeight",
    value: function setWidthAndHeight() {
      this.width = this.canvasWrapper.clientWidth || _constants_ui__WEBPACK_IMPORTED_MODULE_27__.CONTAINER_WIDTH;
      this.height = this.canvasWrapper.clientHeight || _constants_ui__WEBPACK_IMPORTED_MODULE_27__.CONTAINER_HEIGHT;
    }
  }, {
    key: "setPadding",
    value: function setPadding() {
      var _this$options$axis$x$, _this$options$axis$y$;

      var xformatter = (_this$options$axis$x$ = this.options.axis.x.tick) === null || _this$options$axis$x$ === void 0 ? void 0 : _this$options$axis$x$.format;
      var yformatter = (_this$options$axis$y$ = this.options.axis.y.tick) === null || _this$options$axis$y$ === void 0 ? void 0 : _this$options$axis$y$.format;
      var formattedMaxX = xformatter ? xformatter(this.options.axis.x.max) : this.options.axis.x.max;
      var formattedMaxY = yformatter ? yformatter(this.options.axis.y.max) : this.options.axis.y.max;
      var maxXWidth = this.viewport.viewLayer.getTextWidth(formattedMaxX);
      var maxYWidth = this.viewport.viewLayer.getTextWidth(formattedMaxY);
      this.padding.left = (maxXWidth / 2 > maxYWidth ? maxXWidth / 2 : maxYWidth) + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.TEXT_MARGIN_LEFT + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.TEXT_MARGIN_RIGHT + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_TICK_LENGTH;
      this.padding.right = maxXWidth / 2 + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.TEXT_MARGIN_RIGHT;
      this.padding.bottom = this.viewport.viewLayer.getTextHeight(formattedMaxX) + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.TEXT_MARGIN_TOP + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.TEXT_MARGIN_BOTTOM + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_TICK_LENGTH;
    }
  }, {
    key: "setViewPort",
    value: function setViewPort() {
      this.viewport = new _Viewport__WEBPACK_IMPORTED_MODULE_23__.Viewport(this.canvasWrapper, {
        width: this.width,
        height: this.height
      });
    }
  }, {
    key: "setGuide",
    value: function setGuide() {
      this.guide = new _Guide__WEBPACK_IMPORTED_MODULE_30__.Guide(this.canvasWrapper, {
        width: this.width,
        height: this.height,
        padding: this.padding,
        axisOption: this.options.axis,
        ratio: {
          x: this.xRatio,
          y: this.yRatio
        }
      });
    }
  }, {
    key: "setAxis",
    value: function setAxis() {
      var _options$axis$x$tick, _options$axis$y$tick;

      var options = this.options;
      this.yAxis = new _YAxis__WEBPACK_IMPORTED_MODULE_25__.YAxis({
        min: options.axis.y.min,
        max: options.axis.y.max,
        width: this.width,
        height: this.height,
        padding: this.padding,
        priority: -2,
        fixed: true,
        tickOption: options.axis.y.tick
      });
      this.xAxis = new _XAxis__WEBPACK_IMPORTED_MODULE_26__.XAxis({
        min: options.axis.x.min,
        max: options.axis.x.max,
        width: this.width,
        height: this.height,
        padding: this.padding,
        priority: -1,
        tickOption: options.axis.x.tick
      });
      this.gridAxis = new _GridAxis__WEBPACK_IMPORTED_MODULE_28__.GridAxis({
        min: options.axis.x.min,
        max: options.axis.x.max,
        width: this.width,
        height: this.height,
        padding: this.padding,
        priority: 9999,
        xTickCount: (_options$axis$x$tick = options.axis.x.tick) === null || _options$axis$x$tick === void 0 ? void 0 : _options$axis$x$tick.count,
        yTickCount: (_options$axis$y$tick = options.axis.y.tick) === null || _options$axis$y$tick === void 0 ? void 0 : _options$axis$y$tick.count
      });
      this.viewport.addLayer(this.yAxis);
      this.viewport.addLayer(this.xAxis);
      this.viewport.addLayer(this.gridAxis);
    }
  }, {
    key: "setLayers",
    value: function setLayers() {
      var _this = this;

      var width = this.viewport.styleWidth;
      var height = this.viewport.styleHeight;
      var dataOptions = this.options.data;
      dataOptions.forEach(function (_ref) {
        var type = _ref.type,
            _ref$priority = _ref.priority,
            priority = _ref$priority === void 0 ? _constants_ui__WEBPACK_IMPORTED_MODULE_27__.LAYER_DEFAULT_PRIORITY : _ref$priority;

        _this.setLayer(type, width, height, priority);
      });
    }
  }, {
    key: "setLayer",
    value: function setLayer(legend, width, height, priority) {
      var layer = new _Layer__WEBPACK_IMPORTED_MODULE_22__.Layer({
        width: width,
        height: height
      });
      layer.id = legend;
      layer.priority = priority;
      this.layers[legend] = layer;
      this.viewport.addLayer(layer);
    }
  }, {
    key: "setLegends",
    value: function setLegends() {
      var _this$options,
          _this2 = this;

      this.legend = new _Legend__WEBPACK_IMPORTED_MODULE_29__.Legend(this.wrapper, {
        types: Object.keys(this.layers),
        dataColorMap: this.dataColorMap,
        legendOptions: (_this$options = this.options) === null || _this$options === void 0 ? void 0 : _this$options.legend
      });
      this.legend.addEvents(function (_ref2) {
        var type = _ref2.type,
            checked = _ref2.checked;

        if (type) {
          if (checked) {
            _this2.viewport.showLayer(type);
          } else {
            _this2.viewport.hideLayer(type);
          }
        }

        _this2.shoot();
      }).render();
    }
  }, {
    key: "setRatio",
    value: function setRatio() {
      var _this$options2;

      var axis = (_this$options2 = this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.axis;
      var padding = this.padding;
      var width = this.viewport.canvas.width / this.viewport.viewLayer.dpr;
      var height = this.viewport.canvas.height / this.viewport.viewLayer.dpr;
      var minX = axis.x.min;
      var maxX = axis.x.max;
      var minY = axis.y.min;
      var maxY = axis.y.max;
      this.xRatio = (width - padding.left - padding.right - _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING * 2) / (maxX - minX);
      this.yRatio = (height - padding.bottom - padding.top - _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING * 2) / (maxY - minY);
    }
  }, {
    key: "shoot",
    value: function shoot() {
      var _this3 = this;

      this.viewport.clear();
      this.viewport.render(this.coordX, this.coordY);
      Object.keys(this.datas).forEach(function (key) {
        // this.datas[key].sort((a,b) => a - b);
        _this3.legend.setLegendCount(key, _this3.datas[key].length);
      });
    }
  }, {
    key: "animate",
    value: function animate(duration, now) {
      var _this4 = this;

      this.shoot();
      if (!this.t0) this.t0 = now;
      var dt = now - this.t0;
      var pixcelPerFrame = (this.viewport.styleWidth - this.padding.left - this.padding.right - _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING * 2) / duration * dt;
      var pixcelPerSecond = pixcelPerFrame * 60;
      this.t0 = now;
      this.coordX = this.coordX - pixcelPerFrame; // 특정 주기마다 시행

      if (Math.abs(Math.floor(this.coordX)) % Math.floor(pixcelPerSecond / 5) === 0) {
        var x = Math.abs(this.coordX) / this.xRatio;
        Object.keys(this.datas).forEach(function (key) {
          _this4.datas[key] = _this4.datas[key].filter(function (d) {
            return d > x;
          });
        });
        this.guide.updateXAxis({
          min: x + this.xAxis.min
        });
      }

      if (this.coordX > -(this.viewport.styleWidth - this.padding.left - this.padding.right - _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING * 2)) {
        this.reqAnimation = requestAnimationFrame(function (t) {
          return _this4.animate(duration, t);
        });
      } else {
        // swap
        var nextAxisMinX = this.realtimeAxisMinX + (this.realtimeAxisMaxX - this.realtimeAxisMinX) / 2;
        var nextAxisMaxX = this.realtimeAxisMaxX + (this.realtimeAxisMaxX - this.realtimeAxisMinX) / 2;
        this.realtimeAxisMinX = nextAxisMinX;
        this.realtimeAxisMaxX = nextAxisMaxX;
        this.coordX = 0;
        this.xAxis.setMinMax(this.realtimeAxisMinX, this.realtimeAxisMaxX).render();
        Object.values(this.layers).filter(function (layer) {
          return !layer.isFixed;
        }).forEach(function (layer) {
          return layer.swapCanvasImage();
        });
        this.reqAnimation = requestAnimationFrame(function (t) {
          return _this4.animate(duration, t);
        });
      }
    }
  }, {
    key: "render",
    value: function render(data) {
      var _this5 = this;

      var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
          _ref3$append = _ref3.append,
          append = _ref3$append === void 0 ? false : _ref3$append;

      this.setRatio();
      var _this$viewport = this.viewport,
          styleWidth = _this$viewport.styleWidth,
          styleHeight = _this$viewport.styleHeight;
      var padding = this.padding;
      !append && this.viewport.clear();
      data.forEach(function (_ref4, i) {
        var x = _ref4.x,
            y = _ref4.y,
            type = _ref4.type,
            hidden = _ref4.hidden;
        var legend = type ? type : 'unknown';

        if (!_this5.layers[legend]) {
          _this5.setLayer(legend, styleWidth, styleHeight, _constants_ui__WEBPACK_IMPORTED_MODULE_27__.LAYER_DEFAULT_PRIORITY);
        }

        if (_this5.datas[legend]) {
          _this5.datas[legend].push(x);
        } else {
          _this5.datas[legend] = [x];
        }

        !hidden && (0,_utils_draw__WEBPACK_IMPORTED_MODULE_24__.drawCircle)(_this5.layers[legend].context, _this5.xRatio * x + padding.left + _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING, _this5.viewport.canvas.height / _this5.viewport.viewLayer.dpr - _this5.yRatio * y - padding.bottom - _constants_ui__WEBPACK_IMPORTED_MODULE_27__.AXIS_INNER_PADDING, {
          fillColor: _this5.dataColorMap[legend]
        });
      });
      this.shoot();
    }
  }, {
    key: "on",
    value: function on(evetntType, callback) {
      this.guide.on(evetntType, callback);
    }
  }, {
    key: "resize",
    value: function resize(width, height) {
      var w = width || this.canvasWrapper.clientWidth;
      var h = height || this.canvasWrapper.clientHeight;
      this.viewport.setSize(w, h);
      this.setRatio();
      this.xAxis.setSize(w, h);
      this.yAxis.setSize(w, h);
      this.gridAxis.setSize(w, h);
      this.guide.setSizeAndRatio(w, h, {
        x: this.xRatio,
        y: this.yRatio
      });
      Object.values(this.layers).forEach(function (layer) {
        return layer.setSize(w, h);
      });
      this.legend.setSize(w);
      this.shoot();
    } // public startRealtime(duration: number) {
    //   if (this.reqAnimation) return;
    //   const axisOptions = this.options.axis;
    //   this.xAxis
    //     .setTickCount(axisOptions.x.tick?.count! * 2 - 1)
    //     .setSize(this.width * 2 - this.padding.left - AXIS_INNER_PADDING * 2 - this.padding.right, this.height)
    //     .setMinMax(axisOptions.x.min, axisOptions.x.max * 2 - axisOptions.x.min)
    //     .render();
    //   this.realtimeAxisMinX = axisOptions.x.min;
    //   this.realtimeAxisMaxX = axisOptions.x.max * 2 - axisOptions.x.min;
    //   this.gridAxis
    //     .setXTickCount(axisOptions.x.tick?.count! * 2 - 1)
    //     .setSize(this.width * 2 - this.padding.left - AXIS_INNER_PADDING * 2 - this.padding.right, this.height)
    //     .render();
    //   this.animate(duration, this.t0);
    // }
    // public stopRealtime() {
    //   cancelAnimationFrame(this.reqAnimation);
    //   const axisOptions = this.options.axis;
    //   this.reqAnimation = 0;
    //   this.coordX = 0;
    //   this.t0 = 0;
    //   this.xAxis
    //     .setTickCount(axisOptions.x.tick?.count!)
    //     .setSize(this.width, this.height)
    //     .setMinMax(axisOptions.x.min, axisOptions.x.max)
    //     .render();
    //   this.realtimeAxisMinX = axisOptions.x.min;
    //   this.realtimeAxisMaxX = axisOptions.x.max;
    //   this.guide.updateXAxis({ min: axisOptions.x.min });
    //   this.gridAxis
    //     .setXTickCount(axisOptions.x.tick?.count!)
    //     .setSize(this.width, this.height)
    //     .render();
    //   this.shoot();
    // }

  }]);

  return ScatterChart;
}();

/***/ })

});
//# sourceMappingURL=main.f4ff25f49d1e6d0deec1.hot-update.js.map